<!-- Header -->
<nav class="navbar navbar-default navbar-fixed-top navbar-custom">
  <div class="container-fluid">
    <a class="navbar-brand" href="/home/index">Brand</a>
    <ul class="nav navbar-nav nav-icons">
      <li><a href="/home/profile"><i class="fa fa-user fa-2x" aria-hidden="true"></i><span class="sr-only">(current)</span></a></li>
      <li class="current"><a href="/home/my_friends"><i class="fa fa-users fa-2x" aria-hidden="true"></i></a></li>
      <li><a href="/rooms/show"><i class="fa fa-comments-o fa-2x" aria-hidden="true"></i></a></li>
      <li><a href="/users/edit"><i class="fa fa-cog fa-2x" aria-hidden="true"></i></a></li>
      <li><a href="/users/sign_out"><i class="fa fa-sign-out fa-2x" aria-hidden="true"></i></a></li>
    </ul>
  </div>
</nav>
<br><br><br><br>

<!-- User's Group tabs -->
<ul class="nav nav-pills nav-stacked nav-friends">
  <!-- <li class="active"><a href="#All" data-toggle="tab">All</a></li> -->
  <!-- Find User's Groups using user's email -->
  <% GroupUser.where(user_id: @user.id).find_each do |group_tab| %>
    <% Group.where(id: group_tab.group_id).find do |group_name| %>
      <li><a href= "#<%= group_tab.id %>" data-toggle="tab"><%= group_name.name %></a></li>
    <% end %>
  <% end %>
</ul>

<!-- Members(friends) within each Group -->
<div class="tab-content" id="friends-page-tab-content">
  <% GroupUser.where(user_id: @user.id).find_each do |group_tab| %>
    <div class="tab-pane fade in" id="<%= group_tab.id %>">
      <% GroupUser.where(group_id: group_tab.group_id).where.not(user_id: @user.id).find_each do |friends| %>
        <% User.where(id: friends.user_id).find_each do |friends_info| %>
          <button type="button" class="btn member-profile" data-toggle="modal" data-target="#user_profile_<%= friends_info.id %>">
            <div class="member-prof-positioning">
              <div class="orientation-correcter">
                <div class="hex" id="member-hex">
                  <div>
                    <!-- <% unless @user.image_url.nil? %> -->
                      <img src="http://www.readersdigest.ca/wp-content/uploads/2011/01/4-ways-cheer-up-depressed-cat.jpg" alt="profile img">
                    <!-- <% end %> -->
                  </div>
                </div>
              </div>
            </div>
            <%= friends_info.first_name %> <%= friends_info.last_name %>
          </button>
          <div class="modal fade" id="user_profile_<%= friends_info.id %>" tableindex="-1" role="dialog">
            <div class="modal-dialog" role="document">
              <div class="modal-content member-profile-popup">
                <div class="modal-header">
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                  </button>
                  <h4 class="modal-title"><%= friends_info.first_name %>'s profile</h4>
                </div>
                <div class="modal-body">
                  <div class="member-prof-positioning">
                    <div class="orientation-correcter">
                      <div class="hex">
                        <div>
                          <!-- <% unless @user.image_url.nil? %> -->
                            <img src="http://www.readersdigest.ca/wp-content/uploads/2011/01/4-ways-cheer-up-depressed-cat.jpg" alt="profile img">
                          <!-- <% end %> -->
                        </div>
                      </div>
                    </div>
                  </div>
                  <ul class="list-group">
                    <li class="list-group-item">Name: <%= friends_info.first_name %> <%= friends_info.last_name %></li>
                    <li class="list-group-item">Email: <%= friends_info.email %></li>
                    <li class="list-group-item">School: <%= friends_info.school %></li>
                    <li class="list-group-item">Major: <%= friends_info.major %></li>
                    <li class="list-group-item">Class of Year: <%= friends_info.class_year %></li>
                    <li class="list-group-item">Company: <%= friends_info.company %> </li>
                  </ul>
                </div>
                <div class="modal-footer">
                  <button>Send Message</button><br>
                </div>
              </div>
            </div>
          </div>
        <% end %>
      <% end %>
    </div>
  <% end %>
</div>

<script>
  $(document).ready(function(){
    $('.nav-friends li:first-child').addClass("active");
    $('#friends-page-tab-content div:first-child').addClass("active");
  });
</script>
